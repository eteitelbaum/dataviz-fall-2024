{
  "hash": "cf729cfcfc5352fdc22ac26495c4046d",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: Wrangling Data\ndate: today\ndate-format: long\nfooter: \"[DataViz 2102 Website](https://dataviz-gwu.rocks)\"\nlogo: images/dataviz-logo.png\nformat:\n  revealjs:\n    theme: [simple, custom.scss]\n    transition: fade\n    slide-number: true\n    #multiplex: true\n    chalkboard: true\nexecute:\n  echo: true\n  message: false\n  warning: false\n  freeze: auto\n---\n\n\n## Download Some Messy Data\n\n- Create a folder called \"data\" in your course modules project folder\n- Following the instructions in module 1.1, download some messy WB data\n- Make it something other than FLFP\n- Donwload as a CSV file with a unique file name and store in your data folder\n\n## Read Data \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load packages\nlibrary(readr) \nlibrary(dplyr) \n\n# Read data from csv file into an object called \"wb_data_messy\"\nwb_data_messy <- read_csv(\"data/your_file_name.csv\")\n\n# View the data\nglimpse(wb_data_messy)\n```\n:::\n\n\n\n## Messy Data Example\n\n![](images/messy_wb_data.jpg){width=70%}\n\n## Pivot Longer\n\n`pivot_longer()` takes three arguments:\n\n- **cols** - which columns you want to pivot\n- **names_to** - the name of the column where the old column names are going to (identifier)\n- **values_to** - the name of the column where the values are going to\n\n## Without Looking\n\n- Can you remember how to make `pivot_longer()` work? \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load tidyr\nlibrary(tidyr)\n\n# Reshape the data\n      <-    |>\n  pivot_longer(\n    cols = \n    names_to = \n    values_to = \n  )\n\nglimpse()\n```\n:::\n\n\n## Pivot Data \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load tidyr\nlibrary(tidyr)\n\n# Reshape the data\nwb_data <- wb_data_messy |> \n  pivot_longer(             \n    cols = `1973 [YR1973]`: `2022 [YR2022]`, # columns to pivot\n    names_to = \"year\", # name the identifier column \"year\"\n    values_to = \"flfp\" # name the numeric var column \"flfp\"\n  ) \n\n# View the data\nglimpse(wb_data)\n```\n:::\n\n\n## Try With Multiple Variables\n\n- Download more than one variable from the WB \n- Save in a new CSV file\n- Use pivot longer to put in long format\n- And then...\n\n## Multiple Variables\n  \nUse `pivot_wider()`\n  \n\n::: {.cell}\n\n```{.r .cell-code}\nwb_data <- wb_data |>\n  select(-`Series Name`)\n\n# Reshape the data\ntidy_data <- wb_data |> \n  pivot_wider(             \n    names_from = `Series Code`,\n    values_from = values\n  ) \n\n# View the data\nglimpse(wb_data)\n```\n:::\n\n\n## Mutating Variables\n\n- Anytime we want to change a variable, we are going to use the `dplyr` verbs `mutate()` or `mutate_at()`\n- `mutate()` is if you want to change on variable\n- `mutate_at()` is for multiple variables\n\n## Let's Fix Our Variables\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Fix year and flfp\nwb_data <- wb_data |> # replace wb_data with a modified version of the dataframe \n  mutate(year = substring(year, 1, 4)) |> # truncate year (keep first four characters)\n  mutate_at(c(\"year\", \"flfp\"), as.numeric) # change year and flfp to numeric\n\n# View the data\nglimpse(wb_data)\n```\n:::\n\n\n## Now Try it With Multiple Varaibles\n\n- Go to the data frame with multiple variables that you created earlier\n- How would you modify this code to make sure the variables are in the right format? \n\n# Clean Variable Names\n\n| Very simple: use the `janitor` package!\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load janitor\nlibrary(janitor)\n\n# Apply clean_names() to wb_data, store in new data frame called wb_data_clean\nwb_data_clean <- wb_data |>  \n  clean_names() \n\n# Write wb_data_clean to a csv file\nwrite_csv(wb_data_clean, \"data/wb_data_clean.csv\")\n\n# View the data\nglimpse(wb_data_clean)\n```\n:::\n\n\n## Column Specifications\n\n- Can clean columns on backend\n- But can also specify data types in `read_csv()` or `read_excel()`\n\n\n::: {.cell}\n\n```{.r .cell-code}\nspec(wb_data_messy)\n\nwb_data_messy <- read_csv(\"data/your_file_name.csv\", \n                          col_types = cols(\n                           col_double(`1990 [YR1990]`) \n                          )\n                          )\n```\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}